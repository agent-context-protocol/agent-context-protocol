{
    "1": {
        "1": {
            "subtask_description": "List the schema of all tables in any user-defined schema of the database.",
            "steps": {
                "1": {
                    "tool": "query",
                    "handles": "Retrieves table and column information for all user-defined schemas",
                    "input_vars": [
                        {
                            "name": "all_schema_sql",
                            "parameter": [
                                "sql"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "SQL to list table_schema, table_name, column_name, and data_type from all non-system schemas",
                            "value": "SELECT table_schema, table_name, column_name, data_type FROM information_schema.columns WHERE table_schema NOT IN ('information_schema','pg_catalog');",
                            "dependencies": []
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "all_schema_info",
                            "description": "Table and column details for all user-defined schemas",
                            "used_by": [
                                {
                                    "sub_task": 2,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "2": {
            "subtask_description": "Compute the total revenue generated by the customers each sales employee supports, using the schema from sub_task 1.",
            "steps": {
                "1": {
                    "tool": "query",
                    "handles": "Computes total revenue per sales employee using grounded schema info",
                    "input_vars": [
                        {
                            "name": "all_schema_info",
                            "parameter": [
                                "sql"
                            ],
                            "type": "string",
                            "source": "TOOL_Output (sub_task 1, Step 1)",
                            "description": "Use the schema info to construct the correct SQL for employee-customer-revenue aggregation",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 1,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "employee_revenue_list",
                            "description": "List of employees with their total revenue generated by supported customers",
                            "used_by": [
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "3": {
            "subtask_description": "Rank employees by total revenue and extract the top three performers.",
            "steps": {
                "1": {
                    "tool": "perplexity_reason",
                    "handles": "Ranks employees by revenue and extracts the top three performers",
                    "input_vars": [
                        {
                            "name": "employee_revenue_list",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 1)",
                            "description": "List of employees and their total revenue for ranking and extraction",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top_three_employees",
                            "description": "List of top three employees with their names and revenues, ordered by revenue",
                            "used_by": [
                                {
                                    "sub_task": 4,
                                    "step": 1
                                },
                                {
                                    "sub_task": 5,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "4": {
            "subtask_description": "Create a column chart visualizing the top three employees and their total revenues.",
            "steps": {
                "1": {
                    "tool": "generate_chart",
                    "handles": "Generates a column chart for the top three employees and their revenues",
                    "input_vars": [
                        {
                            "name": "chart_type",
                            "parameter": [
                                "type"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "Chart type to use",
                            "value": "bar",
                            "dependencies": []
                        },
                        {
                            "name": "top_three_employees",
                            "parameter": [
                                "datasets"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 3, Step 1)",
                            "description": "Datasets for the top three employees and their revenues",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        },
                        {
                            "name": "chart_title",
                            "parameter": [
                                "title"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "Title for the chart",
                            "value": "Top 3 Sales Employees by Revenue",
                            "dependencies": []
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "chart_url",
                            "description": "URL or reference to the generated column chart",
                            "used_by": []
                        }
                    ]
                }
            }
        },
        "5": {
            "subtask_description": "Generate a brief, rhyming, praising tagline for the top-performing employee.",
            "steps": {
                "1": {
                    "tool": "perplexity_reason",
                    "handles": "Generates a rhyming, praising tagline for the top performer using their name and revenue",
                    "input_vars": [
                        {
                            "name": "top_three_employees",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 3, Step 1)",
                            "description": "List of top three employees (to extract the top performer\u2019s name and revenue for tagline generation)",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top_performer_tagline",
                            "description": "Rhyming, praising tagline for the top-performing employee",
                            "used_by": []
                        }
                    ]
                }
            }
        }
    }
}