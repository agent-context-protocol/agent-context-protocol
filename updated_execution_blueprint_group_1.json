{
    "1": {
        "1": {
            "subtask_description": "List the schema of all tables in the public schema of the database.",
            "steps": {
                "1": {
                    "tool": "query",
                    "handles": "Retrieves all table, column, and data type information from the public schema",
                    "input_vars": [
                        {
                            "name": "get_all_schema_sql",
                            "parameter": [
                                "sql"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "SQL to list table_name, column_name, and data_type for all public tables",
                            "value": "SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema='public';",
                            "dependencies": []
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "all_schema_info",
                            "description": "Schema details for all public tables",
                            "used_by": [
                                {
                                    "sub_task": 2,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "2": {
            "subtask_description": "Compute the total revenue generated by the customers each sales employee supports, and rank employees by revenue.",
            "steps": {
                "1": {
                    "tool": "query",
                    "handles": "Using schema info, computes and ranks total revenue per sales employee",
                    "input_vars": [
                        {
                            "name": "all_schema_info",
                            "parameter": [
                                "sql"
                            ],
                            "type": "string",
                            "source": "TOOL_Output (sub_task 1, Step 1)",
                            "description": "Use schema info to construct and execute the SQL for employee revenue ranking",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 1,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "ranked_employee_revenue",
                            "description": "Ranked list of sales employees with total revenue generated",
                            "used_by": [
                                {
                                    "sub_task": 2,
                                    "step": 2
                                },
                                {
                                    "sub_task": 6,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                },
                "2": {
                    "tool": "query",
                    "handles": "Extracts the top 8 employee names and their revenues for charting",
                    "input_vars": [
                        {
                            "name": "ranked_employee_revenue",
                            "parameter": [
                                "sql"
                            ],
                            "type": "string",
                            "source": "TOOL_Output (sub_task 2, Step 1)",
                            "description": "Use the ranked employee revenue data to extract the top 8 names and revenues",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top8_employee_names",
                            "description": "Array of top 8 employee names, sorted in descending order by revenue",
                            "used_by": [
                                {
                                    "sub_task": 2,
                                    "step": 3
                                },
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        },
                        {
                            "name": "top8_employee_revenues",
                            "description": "Array of top 8 employee revenues, sorted in descending order",
                            "used_by": [
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                },
                "3": {
                    "tool": "perplexity_reason",
                    "handles": "Identifies the top performer\u2019s name from the first element of top8_employee_names",
                    "input_vars": [
                        {
                            "name": "top8_employee_names",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 2)",
                            "description": "Array of descending-sorted top 8 employee names",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 2
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top_performer_name",
                            "description": "Name of the top-performing sales employee",
                            "used_by": [
                                {
                                    "sub_task": 4,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "3": {
            "subtask_description": "Create a column chart visualizing the top eight sales employees by total revenue.",
            "steps": {
                "1": {
                    "tool": "generate_chart",
                    "handles": "Generates a column chart for the top 8 sales employees by revenue",
                    "input_vars": [
                        {
                            "name": "top8_employee_names",
                            "parameter": [
                                "labels"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 2)",
                            "description": "Array of top 8 employee names",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 2
                                }
                            ]
                        },
                        {
                            "name": "top8_employee_revenues",
                            "parameter": [
                                "datasets"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 2)",
                            "description": "Array of top 8 employee revenues",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 2
                                }
                            ]
                        },
                        {
                            "name": "chart_type",
                            "parameter": [
                                "type"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "Chart type",
                            "value": "bar",
                            "dependencies": []
                        },
                        {
                            "name": "chart_title",
                            "parameter": [
                                "title"
                            ],
                            "type": "string",
                            "source": "LLM_Generated",
                            "description": "Title for the chart",
                            "value": "Top 8 Sales Employees by Revenue",
                            "dependencies": []
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top8_chart_url",
                            "description": "URL or reference to the generated column chart",
                            "used_by": [
                                {
                                    "sub_task": 6,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "4": {
            "subtask_description": "Generate a brief, rhyming, praising tagline for the top-performing sales employee.",
            "steps": {
                "1": {
                    "tool": "perplexity_reason",
                    "handles": "Generates a rhyming, praising tagline for the top performer",
                    "input_vars": [
                        {
                            "name": "top_performer_name",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 3)",
                            "description": "Name of the top performer (passed as a user message)",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 3
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "top_performer_tagline",
                            "description": "Rhyming, praising tagline for the top sales employee",
                            "used_by": [
                                {
                                    "sub_task": 6,
                                    "step": 1
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "5": {
            "subtask_description": "List all public Slack channels to retrieve the channel ID for random.",
            "steps": {
                "1": {
                    "tool": "slack_list_channels",
                    "handles": "Lists public Slack channels to find random",
                    "input_vars": [
                        {
                            "name": "slack_channel_limit",
                            "parameter": [
                                "limit"
                            ],
                            "type": "number",
                            "source": "LLM_Generated",
                            "description": "Maximum number of channels to return",
                            "value": "100",
                            "dependencies": []
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "random_channel_id",
                            "description": "Slack channel ID for random",
                            "used_by": [
                                {
                                    "sub_task": 6,
                                    "step": 2
                                }
                            ]
                        }
                    ]
                }
            }
        },
        "6": {
            "subtask_description": "Post a message in the random Slack channel including the ranked list, the chart, and the tagline.",
            "steps": {
                "1": {
                    "tool": "perplexity_reason",
                    "handles": "Combines the ranked list, chart URL, and tagline into a single message for Slack",
                    "input_vars": [
                        {
                            "name": "ranked_employee_revenue",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 2, Step 1)",
                            "description": "Ranked list of sales employees with total revenue generated",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 2,
                                    "step": 1
                                }
                            ]
                        },
                        {
                            "name": "top8_chart_url",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 3, Step 1)",
                            "description": "URL or reference to the generated column chart",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 3,
                                    "step": 1
                                }
                            ]
                        },
                        {
                            "name": "top_performer_tagline",
                            "parameter": [
                                "messages"
                            ],
                            "type": "array",
                            "source": "TOOL_Output (sub_task 4, Step 1)",
                            "description": "Rhyming, praising tagline for the top sales employee",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 4,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "slack_message_text",
                            "description": "Combined message for posting to Slack",
                            "used_by": [
                                {
                                    "sub_task": 6,
                                    "step": 2
                                }
                            ]
                        }
                    ]
                },
                "2": {
                    "tool": "slack_post_message",
                    "handles": "Posts the combined message to random",
                    "input_vars": [
                        {
                            "name": "random_channel_id",
                            "parameter": [
                                "channel_id"
                            ],
                            "type": "string",
                            "source": "TOOL_Output (sub_task 5, Step 1)",
                            "description": "Slack channel ID for random",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 5,
                                    "step": 1
                                }
                            ]
                        },
                        {
                            "name": "slack_message_text",
                            "parameter": [
                                "text"
                            ],
                            "type": "string",
                            "source": "TOOL_Output (sub_task 6, Step 1)",
                            "description": "Combined message for posting to Slack",
                            "value": "None",
                            "dependencies": [
                                {
                                    "sub_task": 6,
                                    "step": 1
                                }
                            ]
                        }
                    ],
                    "output_vars": [
                        {
                            "name": "slack_post_confirmation",
                            "description": "Confirmation or result of posting to Slack",
                            "used_by": []
                        }
                    ]
                }
            }
        }
    }
}